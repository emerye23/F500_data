---
title: "Sector and Industry"
execute: 
  echo: false
---

```{r}
#| message: false
library(tidyverse)
library(dplyr)
library(readr)
library(forcats)
```

```{r}
fortune <- read_csv('data/Cleaned Data.csv', show_col_types = FALSE) |>
  select(name,sector,industry)
```

```{r}
business_sect <- unique(fortune) |>
  select(sector) |>
  drop_na() |>
  count(sector) |>
  mutate(sector = fct_reorder(sector, n, .desc = FALSE))
```

```{r}
business_ind <- unique(fortune) |>
  select(industry) |>
  drop_na() |>
  count(industry) |>
  filter(n > 100) |>
  mutate(industry = fct_reorder(industry, n, .desc = FALSE))
```

```{r}
business_sect |>
  ggplot(aes(x = sector, y = n)) +
  geom_bar(stat = 'identity', fill = '#0000c0') +
  theme(axis.text.y = element_text(angle = 0)) +
  labs(title = "Business Sectors of Fortune 500 Companies",
       subtitle = "Financials, energy, technology, health care, and retailing are the most\ncommon sectors.",
       x = 'Sector',
       y = 'Count') +
  coord_flip()
```

```{r}
business_ind |>
  ggplot(aes(x = industry, y = n)) +
  geom_bar(stat = 'identity', fill = '#0000c0') +
  theme(axis.text.y = element_text(angle = 0)) +
  labs(title = "Industries of Fortune 500 Companies",
       subtitle = "Gas and electric utilities, specialty retailers, commercial banks,\nand chemicals are the most common industries.",
       x = 'Industry',
       y = 'Count') +
  coord_flip()
```