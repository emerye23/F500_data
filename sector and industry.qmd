---
title: "Sector and Industry"
execute: 
  echo: false
---

```{r}
#| message: false
#| warning: false
library(tidyverse)
library(readr)
library(forcats)
```

```{r}
fortune <- read_csv('data/Cleaned Data.csv', show_col_types = FALSE) |>
  select(rank, name, sector, industry)
```

```{r}
business_sect <- unique(fortune) |>
  select(sector) |>
  drop_na() |>
  count(sector) |>
  mutate(sector = fct_reorder(sector, n, .desc = FALSE))
```

```{r}
business_ind <- unique(fortune) |>
  select(industry) |>
  drop_na() |>
  count(industry) |>
  filter(n > 210) |>
  mutate(industry = fct_reorder(industry, n, .desc = FALSE))
```

```{r}
business_sect |>
  ggplot(aes(x = sector, y = n)) +
  geom_bar(stat = 'identity', fill = '#0d6efd') +
  theme(axis.text.y = element_text(angle = 0)) +
  labs(title = "Business Sectors of Fortune 500 Companies",
       subtitle = "Financials, energy, retailing, technology, and health care are the most\ncommon sectors.",
       x = 'Sector',
       y = 'Count',
       caption = 'fortune.com') +
  coord_flip() +
  theme_classic()
```

```{r}
business_ind |>
  ggplot(aes(x = industry, y = n)) +
  geom_bar(stat = 'identity', fill = '#0d6efd') +
  theme(axis.text.y = element_text(angle = 0)) +
  labs(title = "Industries of Fortune 500 Companies",
       subtitle = "Gas and electric ultities, commercial banks, property and casualty\ninsurance, and chemicals are the most common industries.",
       x = 'Industry',
       y = 'Count',
       caption = 'fortune.com') +
  coord_flip() +
  theme_classic()
```