---
title: "Model Training"
execute: 
  echo: false
sidebar: false
---

```{r}
#| message: false
#| warning: false
library(tidyverse)
library(readr)
library(rstanarm)
library(gtsummary)
```

```{r}
read_csv('data/Cleaned Data.csv', show_col_types = FALSE) |>
  select(year, gained_in_rank) |>
  drop_na() |>
  count(gained_in_rank, .by = year)
```

```{r}
train <- read_csv('data/Cleaned Data.csv', show_col_types = FALSE) |>
  select(market_value_mil, year, revenue_mil, profit_mil, asset_mil, employees) |>
  drop_na()
```

```{r}
fit_obj <- stan_glm(formula = market_value_mil ~ year + revenue_mil + profit_mil + asset_mil + employees,
                    data = train,
                    refresh = 0,
                    seed = 42)
```

```{r}
fit_obj
```

```{r}
tbl_regression(fit_obj)
```